<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title> - Friends&#39; Life and Work Space</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="YLShi && WuHongSong" /><meta name="description" content="ğŸ“‹ å¸¸ç”¨å·¥å…·(æ±‡æ€»ç®€ç•¥ä¸å…¨ç‰ˆ) åŠŸèƒ½åˆ†ç±» ä¸»è¦å‘½ä»¤ éªŒè¯çŠ¶æ€ ä½¿ç”¨é¢‘ç‡ é€‚ç”¨åœºæ™¯ é£é™©çº§åˆ« é›†ç¾¤ç›‘æ§ ceph -s, ceph health(detail), ceph df, ceph -w âœ… å·²éªŒè¯ â­â­â­â­â­ æ—¥å¸¸ç›‘æ§ã€æ•…éšœè¯Šæ–­ ğŸŸ¢ æ— " /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.100.2 with theme even" />


<link rel="canonical" href="http://YLShiJustFly.github.io/post/ceph-content/operation-skills/zh-cn/%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97ceph%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="" />
<meta property="og:description" content="ğŸ“‹ å¸¸ç”¨å·¥å…·(æ±‡æ€»ç®€ç•¥ä¸å…¨ç‰ˆ) åŠŸèƒ½åˆ†ç±» ä¸»è¦å‘½ä»¤ éªŒè¯çŠ¶æ€ ä½¿ç”¨é¢‘ç‡ é€‚ç”¨åœºæ™¯ é£é™©çº§åˆ« é›†ç¾¤ç›‘æ§ ceph -s, ceph health(detail), ceph df, ceph -w âœ… å·²éªŒè¯ â­â­â­â­â­ æ—¥å¸¸ç›‘æ§ã€æ•…éšœè¯Šæ–­ ğŸŸ¢ æ— " />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://YLShiJustFly.github.io/post/ceph-content/operation-skills/zh-cn/%E5%AE%9E%E7%94%A8%E6%8C%87%E5%8D%97ceph%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB/" /><meta property="article:section" content="post" />



<meta itemprop="name" content="">
<meta itemprop="description" content="ğŸ“‹ å¸¸ç”¨å·¥å…·(æ±‡æ€»ç®€ç•¥ä¸å…¨ç‰ˆ) åŠŸèƒ½åˆ†ç±» ä¸»è¦å‘½ä»¤ éªŒè¯çŠ¶æ€ ä½¿ç”¨é¢‘ç‡ é€‚ç”¨åœºæ™¯ é£é™©çº§åˆ« é›†ç¾¤ç›‘æ§ ceph -s, ceph health(detail), ceph df, ceph -w âœ… å·²éªŒè¯ â­â­â­â­â­ æ—¥å¸¸ç›‘æ§ã€æ•…éšœè¯Šæ–­ ğŸŸ¢ æ— ">

<meta itemprop="wordCount" content="5831">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="ğŸ“‹ å¸¸ç”¨å·¥å…·(æ±‡æ€»ç®€ç•¥ä¸å…¨ç‰ˆ) åŠŸèƒ½åˆ†ç±» ä¸»è¦å‘½ä»¤ éªŒè¯çŠ¶æ€ ä½¿ç”¨é¢‘ç‡ é€‚ç”¨åœºæ™¯ é£é™©çº§åˆ« é›†ç¾¤ç›‘æ§ ceph -s, ceph health(detail), ceph df, ceph -w âœ… å·²éªŒè¯ â­â­â­â­â­ æ—¥å¸¸ç›‘æ§ã€æ•…éšœè¯Šæ–­ ğŸŸ¢ æ— "/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Friends&#39; Life and Work Space</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Friends&#39; Life and Work Space</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title"></h1>

      <div class="post-meta">
        <span class="post-time"> 0001-01-01 </span>
        
          <span class="more-meta"> 5831 words </span>
          <span class="more-meta"> 12 mins read </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> times read </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#-å¸¸ç”¨å·¥å…·æ±‡æ€»ç®€ç•¥ä¸å…¨ç‰ˆ">ğŸ“‹ å¸¸ç”¨å·¥å…·(æ±‡æ€»ç®€ç•¥ä¸å…¨ç‰ˆ)</a></li>
        <li><a href="#-1-é›†ç¾¤çŠ¶æ€ç›‘æ§">ğŸ”§ 1. é›†ç¾¤çŠ¶æ€ç›‘æ§</a>
          <ul>
            <li><a href="#11-é›†ç¾¤æ•´ä½“çŠ¶æ€">1.1 é›†ç¾¤æ•´ä½“çŠ¶æ€</a></li>
            <li><a href="#12-é›†ç¾¤æ€§èƒ½ç›‘æ§">1.2 é›†ç¾¤æ€§èƒ½ç›‘æ§</a></li>
          </ul>
        </li>
        <li><a href="#-2-osd-ç®¡ç†">ğŸ—„ï¸ 2. OSD ç®¡ç†</a>
          <ul>
            <li><a href="#21-osd-åŸºæœ¬æ“ä½œ">2.1 OSD åŸºæœ¬æ“ä½œ</a></li>
            <li><a href="#22-osd-ç»´æŠ¤æ“ä½œ">2.2 OSD ç»´æŠ¤æ“ä½œ</a></li>
            <li><a href="#23-osd-æ•…éšœæ’æŸ¥">2.3 OSD æ•…éšœæ’æŸ¥</a></li>
          </ul>
        </li>
        <li><a href="#-3-monitor-ç®¡ç†">ğŸ›ï¸ 3. Monitor ç®¡ç†</a>
          <ul>
            <li><a href="#31-monitor-åŸºæœ¬æ“ä½œ">3.1 Monitor åŸºæœ¬æ“ä½œ</a></li>
            <li><a href="#32-monitor-ç»´æŠ¤">3.2 Monitor ç»´æŠ¤</a></li>
          </ul>
        </li>
        <li><a href="#-4-manager-ç®¡ç†">ğŸ‘¨â€ğŸ’¼ 4. Manager ç®¡ç†</a>
          <ul>
            <li><a href="#41-manager-åŸºæœ¬æ“ä½œ">4.1 Manager åŸºæœ¬æ“ä½œ</a></li>
            <li><a href="#42-å¸¸ç”¨-manager-æ¨¡å—">4.2 å¸¸ç”¨ Manager æ¨¡å—</a></li>
          </ul>
        </li>
        <li><a href="#-5-å­˜å‚¨æ± ç®¡ç†">ğŸ—‚ï¸ 5. å­˜å‚¨æ± ç®¡ç†</a>
          <ul>
            <li><a href="#51-pool-åŸºæœ¬æ“ä½œ">5.1 Pool åŸºæœ¬æ“ä½œ</a></li>
            <li><a href="#52-pool-å‚æ•°é…ç½®">5.2 Pool å‚æ•°é…ç½®</a></li>
          </ul>
        </li>
        <li><a href="#-6-æ”¾ç½®ç»„-pg-ç®¡ç†">ğŸ“„ 6. æ”¾ç½®ç»„ (PG) ç®¡ç†</a>
          <ul>
            <li><a href="#61-pg-çŠ¶æ€æŸ¥çœ‹">6.1 PG çŠ¶æ€æŸ¥çœ‹</a></li>
            <li><a href="#62-pg-ä¿®å¤æ“ä½œ">6.2 PG ä¿®å¤æ“ä½œ</a></li>
          </ul>
        </li>
        <li><a href="#-7-è®¤è¯ç®¡ç†">ğŸ” 7. è®¤è¯ç®¡ç†</a>
          <ul>
            <li><a href="#71-ç”¨æˆ·ç®¡ç†">7.1 ç”¨æˆ·ç®¡ç†</a></li>
            <li><a href="#72-æƒé™ç®¡ç†">7.2 æƒé™ç®¡ç†</a></li>
          </ul>
        </li>
        <li><a href="#-8-crush-map-ç®¡ç†">ğŸ—ï¸ 8. CRUSH Map ç®¡ç†</a>
          <ul>
            <li><a href="#81-crush-åŸºæœ¬æ“ä½œ">8.1 CRUSH åŸºæœ¬æ“ä½œ</a></li>
            <li><a href="#82-crush-è§„åˆ™ç®¡ç†">8.2 CRUSH è§„åˆ™ç®¡ç†</a></li>
          </ul>
        </li>
        <li><a href="#-9-rbd-ç®¡ç†">ğŸ¯ 9. RBD ç®¡ç†</a>
          <ul>
            <li><a href="#91-rbd-åŸºæœ¬æ“ä½œ">9.1 RBD åŸºæœ¬æ“ä½œ</a></li>
            <li><a href="#92-rbd-é«˜çº§æ“ä½œ">9.2 RBD é«˜çº§æ“ä½œ</a></li>
          </ul>
        </li>
        <li><a href="#-10-cephfs-ç®¡ç†">ğŸŒ 10. CephFS ç®¡ç†</a>
          <ul>
            <li><a href="#101-cephfs-åŸºæœ¬æ“ä½œ">10.1 CephFS åŸºæœ¬æ“ä½œ</a></li>
            <li><a href="#102-cephfs-å®¢æˆ·ç«¯">10.2 CephFS å®¢æˆ·ç«¯</a></li>
            <li><a href="#103-cephfs-é«˜çº§ç®¡ç†">10.3 CephFS é«˜çº§ç®¡ç†</a></li>
          </ul>
        </li>
        <li><a href="#-11-rgw-ç®¡ç†">â˜ï¸ 11. RGW ç®¡ç†</a>
          <ul>
            <li><a href="#111-rgw-åŸºæœ¬æ“ä½œ">11.1 RGW åŸºæœ¬æ“ä½œ</a></li>
            <li><a href="#112-rgw-å¯†é’¥ç®¡ç†">11.2 RGW å¯†é’¥ç®¡ç†</a></li>
            <li><a href="#113-rgw-ç»´æŠ¤">11.3 RGW ç»´æŠ¤</a></li>
          </ul>
        </li>
        <li><a href="#-12-é…ç½®ç®¡ç†">ğŸ”§ 12. é…ç½®ç®¡ç†</a>
          <ul>
            <li><a href="#121-è¿è¡Œæ—¶é…ç½®">12.1 è¿è¡Œæ—¶é…ç½®</a></li>
            <li><a href="#122-ä¸´æ—¶é…ç½®è°ƒæ•´">12.2 ä¸´æ—¶é…ç½®è°ƒæ•´</a></li>
          </ul>
        </li>
        <li><a href="#-13-æ€§èƒ½åˆ†æä¸“é¡¹">ğŸ“ˆ 13. æ€§èƒ½åˆ†æä¸“é¡¹</a>
          <ul>
            <li><a href="#131-rbd-æ€§èƒ½åˆ†æ">13.1 RBD æ€§èƒ½åˆ†æ</a></li>
            <li><a href="#132-cephfs-æ€§èƒ½åˆ†æ">13.2 CephFS æ€§èƒ½åˆ†æ</a></li>
            <li><a href="#133-osd-æ€§èƒ½åˆ†æ">13.3 OSD æ€§èƒ½åˆ†æ</a></li>
            <li><a href="#134-æ•´ä½“é›†ç¾¤æ€§èƒ½åˆ†æ">13.4 æ•´ä½“é›†ç¾¤æ€§èƒ½åˆ†æ</a></li>
          </ul>
        </li>
        <li><a href="#-14-ceph-ä¸“ç”¨å·¥å…·é›†">ğŸ› ï¸ 14. Ceph ä¸“ç”¨å·¥å…·é›†</a>
          <ul>
            <li><a href="#141-æ•°æ®æ¢å¤å’Œè¯Šæ–­å·¥å…·">14.1 æ•°æ®æ¢å¤å’Œè¯Šæ–­å·¥å…·</a></li>
            <li><a href="#142-ç›‘æ§å’Œç®¡ç†å·¥å…·">14.2 ç›‘æ§å’Œç®¡ç†å·¥å…·</a></li>
            <li><a href="#143-æ•°æ®è¿ç§»å’ŒåŒæ­¥å·¥å…·">14.3 æ•°æ®è¿ç§»å’ŒåŒæ­¥å·¥å…·</a></li>
          </ul>
        </li>
        <li><a href="#-15-æ•…éšœæ’æŸ¥">ğŸš¨ 15. æ•…éšœæ’æŸ¥</a>
          <ul>
            <li><a href="#151-æ—¥å¿—æŸ¥çœ‹">15.1 æ—¥å¿—æŸ¥çœ‹</a></li>
            <li><a href="#152-å¸¸è§é—®é¢˜æ’æŸ¥">15.2 å¸¸è§é—®é¢˜æ’æŸ¥</a></li>
          </ul>
        </li>
        <li><a href="#-16-å¤‡ä»½æ¢å¤">ğŸ”„ 16. å¤‡ä»½æ¢å¤</a>
          <ul>
            <li><a href="#161-æ•°æ®å¤‡ä»½">16.1 æ•°æ®å¤‡ä»½</a></li>
            <li><a href="#162-ç¾éš¾æ¢å¤">16.2 ç¾éš¾æ¢å¤</a></li>
            <li><a href="#163-rbd-å¤‡ä»½æ¢å¤">16.3 RBD å¤‡ä»½æ¢å¤</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="-å¸¸ç”¨å·¥å…·æ±‡æ€»ç®€ç•¥ä¸å…¨ç‰ˆ">ğŸ“‹ å¸¸ç”¨å·¥å…·(æ±‡æ€»ç®€ç•¥ä¸å…¨ç‰ˆ)</h2>
<table>
<thead>
<tr>
<th>åŠŸèƒ½åˆ†ç±»</th>
<th>ä¸»è¦å‘½ä»¤</th>
<th>éªŒè¯çŠ¶æ€</th>
<th>ä½¿ç”¨é¢‘ç‡</th>
<th>é€‚ç”¨åœºæ™¯</th>
<th>é£é™©çº§åˆ«</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>é›†ç¾¤ç›‘æ§</strong></td>
<td><code>ceph -s</code>, <code>ceph health(detail)</code>, <code>ceph df</code>, <code>ceph -w</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­â­â­</td>
<td>æ—¥å¸¸ç›‘æ§ã€æ•…éšœè¯Šæ–­</td>
<td>ğŸŸ¢ æ— é£é™©</td>
</tr>
<tr>
<td><strong>I/Oç›‘æ§</strong></td>
<td><code>ceph iostat</code>(ç‰ˆæœ¬ç›¸å…³,Nä»¥ä¸Š), <code>ceph -w</code>, <code>ceph status</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­â­</td>
<td>æ€§èƒ½ç›‘æ§</td>
<td>ğŸŸ¢ æ— é£é™©</td>
</tr>
<tr>
<td><strong>OSDç®¡ç†</strong></td>
<td><code>ceph osd tree</code>, <code>ceph osd status</code>, <code>ceph osd out/in</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­â­</td>
<td>OSDç»´æŠ¤ã€å®¹é‡ç®¡ç†</td>
<td>ğŸŸ¡ ä¸­ç­‰é£é™© (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
<tr>
<td><strong>Monitorç®¡ç†</strong></td>
<td><code>ceph mon stat</code>, <code>ceph quorum_status</code>, <code>ceph mon add/remove</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­</td>
<td>é›†ç¾¤ç®¡ç†ã€é«˜å¯ç”¨</td>
<td>ğŸ”´ é«˜é£é™© (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
<tr>
<td><strong>Managerç®¡ç†</strong></td>
<td><code>ceph mgr module enable/disable</code>, <code>ceph mgr stat</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­</td>
<td>åŠŸèƒ½ç®¡ç†ã€ä»ªè¡¨æ¿</td>
<td>ğŸŸ¡ ä¸­ç­‰é£é™© (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
<tr>
<td><strong>å­˜å‚¨æ± ç®¡ç†</strong></td>
<td><code>ceph osd pool create/delete</code>, <code>ceph osd pool set</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­â­</td>
<td>å­˜å‚¨è§„åˆ’ã€é…é¢ç®¡ç†</td>
<td>ğŸ”´ é«˜é£é™© (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
<tr>
<td><strong>PGç®¡ç†</strong></td>
<td><code>ceph pg stat</code>, <code>ceph pg repair</code>, <code>ceph pg scrub</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­â­</td>
<td>æ•°æ®å®Œæ•´æ€§ã€æ•…éšœä¿®å¤</td>
<td>ğŸŸ¡ ä¸­ç­‰é£é™© (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
<tr>
<td><strong>è®¤è¯ç®¡ç†</strong></td>
<td><code>ceph auth list/create/del</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­</td>
<td>å®‰å…¨ç®¡ç†ã€æƒé™æ§åˆ¶</td>
<td>ğŸ”´ é«˜é£é™© (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
<tr>
<td><strong>CRUSHç®¡ç†</strong></td>
<td><code>ceph osd crush tree</code>, <code>crushtool</code>, <code>ceph osd crush rule</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­</td>
<td>æ•°æ®åˆ†å¸ƒã€æ•…éšœåŸŸ</td>
<td>ğŸ”´ é«˜é£é™© (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
<tr>
<td><strong>RBDç®¡ç†</strong></td>
<td><code>rbd create/rm</code>, <code>rbd snap create</code>, <code>rbd map/unmap</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­â­</td>
<td>å—å­˜å‚¨ã€å¿«ç…§ç®¡ç†</td>
<td>ğŸŸ¡ ä¸­ç­‰é£é™©</td>
</tr>
<tr>
<td><strong>CephFSç®¡ç†</strong></td>
<td><code>ceph fs status</code>, <code>ceph mds stat</code>, <code>ceph fs dump</code>, <code>ceph mds fail</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­</td>
<td>æ–‡ä»¶ç³»ç»Ÿã€å…ƒæ•°æ®</td>
<td>ğŸŸ¡ ä¸­ç­‰é£é™© (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
<tr>
<td><strong>RGWç®¡ç†</strong></td>
<td><code>radosgw-admin user create</code>, <code>radosgw-admin bucket</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­</td>
<td>å¯¹è±¡å­˜å‚¨ã€ç”¨æˆ·ç®¡ç†</td>
<td>ğŸŸ¡ ä¸­ç­‰é£é™©  (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
<tr>
<td><strong>é…ç½®ç®¡ç†</strong></td>
<td><code>ceph config set/get</code>, <code>ceph tell</code></td>
<td>æœªéªŒè¯</td>
<td>â­â­â­â­</td>
<td>å‚æ•°è°ƒä¼˜ã€æ•…éšœå¤„ç†</td>
<td>ğŸŸ¡ ä¸­ç­‰é£é™© (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
<tr>
<td><strong>æ€§èƒ½åˆ†æ</strong></td>
<td><code>ceph osd perf</code>,<code>rbd perf image iostat</code>, cephfs-top</td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­</td>
<td>æ€§èƒ½æµ‹è¯•ã€ç“¶é¢ˆåˆ†æ</td>
<td>ğŸŸ¢ æ— é£é™©</td>
</tr>
<tr>
<td><strong>ä¸“ç”¨å·¥å…·</strong></td>
<td><code>ceph-objectstore-tool</code>, <code>ceph-bluestore-tool</code></td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­</td>
<td>æ•°æ®æ¢å¤ã€æ·±åº¦è¯Šæ–­</td>
<td>ğŸ”´ é«˜é£é™© (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
<tr>
<td><strong>æ•…éšœæ’æŸ¥</strong></td>
<td><code>journalctl</code>, <code>ceph daemon dump</code>, æ—¥å¿—åˆ†æ</td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­â­â­</td>
<td>é—®é¢˜è¯Šæ–­ã€æ ¹å› åˆ†æ</td>
<td>ğŸŸ¢ æ— é£é™©</td>
</tr>
<tr>
<td><strong>å¤‡ä»½æ¢å¤</strong></td>
<td><code>ceph mon getmap</code>, <code>ceph auth export</code>, æ•°æ®å¯¼å‡º</td>
<td>âœ… å·²éªŒè¯</td>
<td>â­â­</td>
<td>ç¾éš¾æ¢å¤ã€è¿ç§»</td>
<td>ğŸŸ¡ ä¸­ç­‰é£é™© (æŸ¥è¯¢æ— é£é™©)</td>
</tr>
</tbody>
</table>
<h2 id="-1-é›†ç¾¤çŠ¶æ€ç›‘æ§">ğŸ”§ 1. é›†ç¾¤çŠ¶æ€ç›‘æ§</h2>
<h3 id="11-é›†ç¾¤æ•´ä½“çŠ¶æ€">1.1 é›†ç¾¤æ•´ä½“çŠ¶æ€</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ï¼ˆæœ€å¸¸ç”¨ï¼‰</span>
</span></span><span class="line"><span class="cl">ceph status
</span></span><span class="line"><span class="cl">ceph -s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹é›†ç¾¤å¥åº·çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">ceph health
</span></span><span class="line"><span class="cl">ceph health detail
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®æ—¶ç›‘æ§é›†ç¾¤çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">ceph -w
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹é›†ç¾¤å­˜å‚¨ä½¿ç”¨æƒ…å†µ</span>
</span></span><span class="line"><span class="cl">ceph df
</span></span><span class="line"><span class="cl">ceph df detail
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹é›†ç¾¤ç‰ˆæœ¬ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph version
</span></span><span class="line"><span class="cl">ceph versions
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="12-é›†ç¾¤æ€§èƒ½ç›‘æ§">1.2 é›†ç¾¤æ€§èƒ½ç›‘æ§</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹é›†ç¾¤ I/O ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">ceph iostat
</span></span><span class="line"><span class="cl">watch <span class="s2">&#34;ceph iostat&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ OSD æ€§èƒ½ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">ceph osd perf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹æ…¢è¯·æ±‚</span>
</span></span><span class="line"><span class="cl">ceph daemon osd.X dump_slow_requests
</span></span><span class="line"><span class="cl">ceph daemon osd.X dump_historic_slow_ops
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># PG åˆ†å¸ƒåˆ†æ</span>
</span></span><span class="line"><span class="cl">ceph pg dump <span class="p">|</span> grep ^pg <span class="p">|</span> awk <span class="s1">&#39;{print $1,$15}&#39;</span> <span class="p">|</span> sort
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-2-osd-ç®¡ç†">ğŸ—„ï¸ 2. OSD ç®¡ç†</h2>
<h3 id="21-osd-åŸºæœ¬æ“ä½œ">2.1 OSD åŸºæœ¬æ“ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ OSD çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">ceph osd stat
</span></span><span class="line"><span class="cl">ceph osd dump
</span></span><span class="line"><span class="cl">ceph osd tree
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ OSD ä½¿ç”¨æƒ…å†µ</span>
</span></span><span class="line"><span class="cl">ceph osd df
</span></span><span class="line"><span class="cl">ceph osd df tree
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯åŠ¨/åœæ­¢ OSD</span>
</span></span><span class="line"><span class="cl">systemctl start ceph-osd@X
</span></span><span class="line"><span class="cl">systemctl stop ceph-osd@X
</span></span><span class="line"><span class="cl">systemctl restart ceph-osd@X
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å°† OSD æ ‡è®°ä¸º out/in</span>
</span></span><span class="line"><span class="cl">ceph osd out X
</span></span><span class="line"><span class="cl">ceph osd in X
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å°† OSD æ ‡è®°ä¸º down/up</span>
</span></span><span class="line"><span class="cl">ceph osd down X
</span></span><span class="line"><span class="cl">ceph osd up X
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="22-osd-ç»´æŠ¤æ“ä½œ">2.2 OSD ç»´æŠ¤æ“ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å®‰å…¨ç§»é™¤ OSDï¼ˆå®Œæ•´æµç¨‹ï¼‰</span>
</span></span><span class="line"><span class="cl">ceph osd out X                              <span class="c1"># æ ‡è®°ä¸ºoutï¼Œå¼€å§‹æ•°æ®è¿ç§»</span>
</span></span><span class="line"><span class="cl">ceph osd safe-to-destroy X                  <span class="c1"># æ£€æŸ¥æ˜¯å¦å®‰å…¨ç§»é™¤</span>
</span></span><span class="line"><span class="cl">ceph osd destroy X --yes-i-really-mean-it   <span class="c1"># é”€æ¯OSD</span>
</span></span><span class="line"><span class="cl">ceph osd crush remove osd.X                 <span class="c1"># ä»CRUSH mapç§»é™¤</span>
</span></span><span class="line"><span class="cl">ceph auth del osd.X                         <span class="c1"># åˆ é™¤è®¤è¯ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph osd rm X                               <span class="c1"># ä»é›†ç¾¤ç§»é™¤</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ›¿æ¢æ•…éšœ OSD</span>
</span></span><span class="line"><span class="cl">ceph osd destroy X --yes-i-really-mean-it
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é‡æ–°æƒè¡¡ OSD</span>
</span></span><span class="line"><span class="cl">ceph osd reweight X 0.8                     <span class="c1"># ä¸´æ—¶æƒé‡è°ƒæ•´</span>
</span></span><span class="line"><span class="cl">ceph osd crush reweight osd.X 2.0           <span class="c1"># æ°¸ä¹…æƒé‡è°ƒæ•´</span>
</span></span><span class="line"><span class="cl">ceph osd reweight-by-utilization            <span class="c1"># æŒ‰ä½¿ç”¨ç‡è‡ªåŠ¨è°ƒæ•´æƒé‡</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="23-osd-æ•…éšœæ’æŸ¥">2.3 OSD æ•…éšœæ’æŸ¥</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ OSD è¯¦ç»†ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph osd find X
</span></span><span class="line"><span class="cl">ceph osd metadata X
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ OSD æ—¥å¿—</span>
</span></span><span class="line"><span class="cl">journalctl -u ceph-osd@X -f
</span></span><span class="line"><span class="cl">journalctl -u ceph-osd@X --since <span class="s2">&#34;1 hour ago&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä¿®å¤ OSD</span>
</span></span><span class="line"><span class="cl">ceph osd scrub X
</span></span><span class="line"><span class="cl">ceph osd deep-scrub X
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ OSD çš„ PG</span>
</span></span><span class="line"><span class="cl">ceph pg ls-by-osd X
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># OSD æ€§èƒ½è¯Šæ–­</span>
</span></span><span class="line"><span class="cl">ceph daemon osd.X perf dump
</span></span><span class="line"><span class="cl">ceph daemon osd.X dump_ops_in_flight
</span></span><span class="line"><span class="cl">ceph daemon osd.X dump_blocked_ops
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-3-monitor-ç®¡ç†">ğŸ›ï¸ 3. Monitor ç®¡ç†</h2>
<h3 id="31-monitor-åŸºæœ¬æ“ä½œ">3.1 Monitor åŸºæœ¬æ“ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ Monitor çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">ceph mon stat
</span></span><span class="line"><span class="cl">ceph mon dump
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ Monitor ä»²è£çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">ceph quorum_status
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ·»åŠ  Monitor</span>
</span></span><span class="line"><span class="cl">ceph mon add &lt;mon-id&gt; &lt;mon-addr&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç§»é™¤ Monitor</span>
</span></span><span class="line"><span class="cl">ceph mon remove &lt;mon-id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ Monitor æ˜ å°„</span>
</span></span><span class="line"><span class="cl">ceph mon getmap -o /tmp/monmap
</span></span><span class="line"><span class="cl">monmaptool --print /tmp/monmap
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="32-monitor-ç»´æŠ¤">3.2 Monitor ç»´æŠ¤</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å¯åŠ¨/åœæ­¢ Monitor</span>
</span></span><span class="line"><span class="cl">systemctl start ceph-mon@&lt;hostname&gt;
</span></span><span class="line"><span class="cl">systemctl stop ceph-mon@&lt;hostname&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‹ç¼© Monitor æ•°æ®åº“</span>
</span></span><span class="line"><span class="cl">ceph tell mon.&lt;mon-id&gt; compact
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åŒæ­¥ Monitor æ—¶é—´</span>
</span></span><span class="line"><span class="cl">ceph time-sync-status
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Monitor æ•…éšœæ¢å¤</span>
</span></span><span class="line"><span class="cl">ceph-mon --extract-monmap /tmp/monmap --mon-data /var/lib/ceph/mon/ceph-&lt;id&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-4-manager-ç®¡ç†">ğŸ‘¨â€ğŸ’¼ 4. Manager ç®¡ç†</h2>
<h3 id="41-manager-åŸºæœ¬æ“ä½œ">4.1 Manager åŸºæœ¬æ“ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ Manager çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">ceph mgr stat
</span></span><span class="line"><span class="cl">ceph mgr dump
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯ç”¨/ç¦ç”¨ Manager æ¨¡å—</span>
</span></span><span class="line"><span class="cl">ceph mgr module <span class="nb">enable</span> &lt;module&gt;
</span></span><span class="line"><span class="cl">ceph mgr module disable &lt;module&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å¯ç”¨æ¨¡å—</span>
</span></span><span class="line"><span class="cl">ceph mgr module ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ•…éšœè½¬ç§» Manager</span>
</span></span><span class="line"><span class="cl">ceph mgr fail &lt;mgr-id&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="42-å¸¸ç”¨-manager-æ¨¡å—">4.2 å¸¸ç”¨ Manager æ¨¡å—</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Dashboard æ¨¡å—</span>
</span></span><span class="line"><span class="cl">ceph mgr module <span class="nb">enable</span> dashboard
</span></span><span class="line"><span class="cl">ceph dashboard create-self-signed-cert
</span></span><span class="line"><span class="cl">ceph dashboard ac-user-create &lt;username&gt; -i &lt;password-file&gt;
</span></span><span class="line"><span class="cl">ceph dashboard ac-role-add-scope-perms admin read-write pool
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> mgr mgr/dashboard/server_addr 0.0.0.0
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> mgr mgr/dashboard/server_port <span class="m">8443</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Prometheus æ¨¡å—</span>
</span></span><span class="line"><span class="cl">ceph mgr module <span class="nb">enable</span> prometheus
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> mgr mgr/prometheus/server_addr 0.0.0.0
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> mgr mgr/prometheus/server_port <span class="m">9283</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Balancer æ¨¡å—</span>
</span></span><span class="line"><span class="cl">ceph mgr module <span class="nb">enable</span> balancer
</span></span><span class="line"><span class="cl">ceph balancer mode upmap
</span></span><span class="line"><span class="cl">ceph balancer on
</span></span><span class="line"><span class="cl">ceph balancer status
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Alerts æ¨¡å—</span>
</span></span><span class="line"><span class="cl">ceph mgr module <span class="nb">enable</span> alerts
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-5-å­˜å‚¨æ± ç®¡ç†">ğŸ—‚ï¸ 5. å­˜å‚¨æ± ç®¡ç†</h2>
<h3 id="51-pool-åŸºæœ¬æ“ä½œ">5.1 Pool åŸºæœ¬æ“ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºå­˜å‚¨æ± </span>
</span></span><span class="line"><span class="cl">ceph osd pool create &lt;poolname&gt; &lt;pg_num&gt; <span class="o">[</span>pgp_num<span class="o">]</span>
</span></span><span class="line"><span class="cl">ceph osd pool create rbd <span class="m">128</span> <span class="m">128</span> replicated
</span></span><span class="line"><span class="cl">ceph osd pool create mypool <span class="m">64</span> <span class="m">64</span> erasure
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ é™¤å­˜å‚¨æ± </span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> mon mon_allow_pool_delete <span class="nb">true</span>
</span></span><span class="line"><span class="cl">ceph osd pool delete &lt;poolname&gt; &lt;poolname&gt; --yes-i-really-really-mean-it
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å­˜å‚¨æ± </span>
</span></span><span class="line"><span class="cl">ceph osd lspools
</span></span><span class="line"><span class="cl">ceph osd pool ls detail
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾ç½®å­˜å‚¨æ± é…é¢</span>
</span></span><span class="line"><span class="cl">ceph osd pool set-quota &lt;poolname&gt; max_objects <span class="m">1000</span>
</span></span><span class="line"><span class="cl">ceph osd pool set-quota &lt;poolname&gt; max_bytes 1TB
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å­˜å‚¨æ± ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">ceph osd pool stats
</span></span><span class="line"><span class="cl">ceph osd pool stats &lt;poolname&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="52-pool-å‚æ•°é…ç½®">5.2 Pool å‚æ•°é…ç½®</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># è®¾ç½®å­˜å‚¨æ± å‰¯æœ¬æ•°</span>
</span></span><span class="line"><span class="cl">ceph osd pool <span class="nb">set</span> &lt;poolname&gt; size <span class="m">3</span>
</span></span><span class="line"><span class="cl">ceph osd pool <span class="nb">set</span> &lt;poolname&gt; min_size <span class="m">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾ç½® PG æ•°é‡</span>
</span></span><span class="line"><span class="cl">ceph osd pool <span class="nb">set</span> &lt;poolname&gt; pg_num <span class="m">128</span>
</span></span><span class="line"><span class="cl">ceph osd pool <span class="nb">set</span> &lt;poolname&gt; pgp_num <span class="m">128</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾ç½®å­˜å‚¨æ± ç±»å‹</span>
</span></span><span class="line"><span class="cl">ceph osd pool <span class="nb">set</span> &lt;poolname&gt; crush_rule &lt;rule-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯ç”¨/ç¦ç”¨åŠŸèƒ½</span>
</span></span><span class="line"><span class="cl">ceph osd pool <span class="nb">set</span> &lt;poolname&gt; noscrub <span class="nb">true</span>
</span></span><span class="line"><span class="cl">ceph osd pool <span class="nb">set</span> &lt;poolname&gt; nodeep-scrub <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Pool åº”ç”¨æ ‡ç­¾</span>
</span></span><span class="line"><span class="cl">ceph osd pool application <span class="nb">enable</span> &lt;poolname&gt; rbd
</span></span><span class="line"><span class="cl">ceph osd pool application <span class="nb">enable</span> &lt;poolname&gt; cephfs
</span></span><span class="line"><span class="cl">ceph osd pool application <span class="nb">enable</span> &lt;poolname&gt; rgw
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-6-æ”¾ç½®ç»„-pg-ç®¡ç†">ğŸ“„ 6. æ”¾ç½®ç»„ (PG) ç®¡ç†</h2>
<h3 id="61-pg-çŠ¶æ€æŸ¥çœ‹">6.1 PG çŠ¶æ€æŸ¥çœ‹</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ PG çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">ceph pg stat
</span></span><span class="line"><span class="cl">ceph pg dump
</span></span><span class="line"><span class="cl">ceph pg dump --format json-pretty
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å¼‚å¸¸ PG</span>
</span></span><span class="line"><span class="cl">ceph pg dump_stuck
</span></span><span class="line"><span class="cl">ceph pg dump_stuck inactive
</span></span><span class="line"><span class="cl">ceph pg dump_stuck unclean
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ç‰¹å®š PG ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph pg &lt;pgid&gt; query
</span></span><span class="line"><span class="cl">ceph pg map &lt;pgid&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="62-pg-ä¿®å¤æ“ä½œ">6.2 PG ä¿®å¤æ“ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä¿®å¤ PG</span>
</span></span><span class="line"><span class="cl">ceph pg repair &lt;pgid&gt;
</span></span><span class="line"><span class="cl">ceph pg scrub &lt;pgid&gt;
</span></span><span class="line"><span class="cl">ceph pg deep-scrub &lt;pgid&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¼ºåˆ¶ä¿®å¤ä¸ä¸€è‡´çš„å¯¹è±¡</span>
</span></span><span class="line"><span class="cl">ceph pg force-recovery &lt;pgid&gt;
</span></span><span class="line"><span class="cl">ceph pg force-backfill &lt;pgid&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ PG çš„ OSD</span>
</span></span><span class="line"><span class="cl">ceph pg ls-by-pool &lt;poolname&gt;
</span></span><span class="line"><span class="cl">ceph pg ls-by-primary &lt;osd-id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># PG è‡ªåŠ¨ä¿®å¤</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> osd osd_scrub_auto_repair <span class="nb">true</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-7-è®¤è¯ç®¡ç†">ğŸ” 7. è®¤è¯ç®¡ç†</h2>
<h3 id="71-ç”¨æˆ·ç®¡ç†">7.1 ç”¨æˆ·ç®¡ç†</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹è®¤è¯ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph auth list
</span></span><span class="line"><span class="cl">ceph auth get client.admin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºç”¨æˆ·</span>
</span></span><span class="line"><span class="cl">ceph auth get-or-create client.&lt;name&gt; mon <span class="s1">&#39;allow r&#39;</span> osd <span class="s1">&#39;allow rw pool=&lt;poolname&gt;&#39;</span>
</span></span><span class="line"><span class="cl">ceph auth get-or-create client.rbd mon <span class="s1">&#39;profile rbd&#39;</span> osd <span class="s1">&#39;profile rbd pool=rbd&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ é™¤ç”¨æˆ·</span>
</span></span><span class="line"><span class="cl">ceph auth del client.&lt;name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯¼å‡º/å¯¼å…¥å¯†é’¥</span>
</span></span><span class="line"><span class="cl">ceph auth <span class="nb">export</span> client.&lt;name&gt; &gt; client.&lt;name&gt;.keyring
</span></span><span class="line"><span class="cl">ceph auth import -i client.&lt;name&gt;.keyring
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="72-æƒé™ç®¡ç†">7.2 æƒé™ç®¡ç†</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä¿®æ”¹ç”¨æˆ·æƒé™</span>
</span></span><span class="line"><span class="cl">ceph auth caps client.&lt;name&gt; mon <span class="s1">&#39;allow r&#39;</span> osd <span class="s1">&#39;allow rw pool=rbd&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹æƒé™</span>
</span></span><span class="line"><span class="cl">ceph auth get client.&lt;name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆå®¢æˆ·ç«¯é…ç½®</span>
</span></span><span class="line"><span class="cl">ceph config generate-minimal-conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¸¸ç”¨æƒé™æ¨¡æ¿</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åªè¯»ç”¨æˆ·ï¼šmon &#39;allow r&#39; osd &#39;allow r&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># RBDç”¨æˆ·ï¼šmon &#39;profile rbd&#39; osd &#39;profile rbd pool=rbd&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CephFSç”¨æˆ·ï¼šmon &#39;allow r&#39; mds &#39;allow rw&#39; osd &#39;allow rw pool=cephfs_data&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-8-crush-map-ç®¡ç†">ğŸ—ï¸ 8. CRUSH Map ç®¡ç†</h2>
<h3 id="81-crush-åŸºæœ¬æ“ä½œ">8.1 CRUSH åŸºæœ¬æ“ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ CRUSH map</span>
</span></span><span class="line"><span class="cl">ceph osd tree
</span></span><span class="line"><span class="cl">ceph osd crush tree
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯¼å‡º/å¯¼å…¥ CRUSH map</span>
</span></span><span class="line"><span class="cl">ceph osd getcrushmap -o crushmap.bin
</span></span><span class="line"><span class="cl">crushtool -d crushmap.bin -o crushmap.txt
</span></span><span class="line"><span class="cl">crushtool -c crushmap.txt -o crushmap-new.bin
</span></span><span class="line"><span class="cl">ceph osd setcrushmap -i crushmap-new.bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»º/åˆ é™¤ bucket</span>
</span></span><span class="line"><span class="cl">ceph osd crush add-bucket &lt;bucket-name&gt; &lt;bucket-type&gt;
</span></span><span class="line"><span class="cl">ceph osd crush remove &lt;bucket-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç§»åŠ¨ OSD åˆ°ä¸åŒä½ç½®</span>
</span></span><span class="line"><span class="cl">ceph osd crush move osd.X <span class="nv">host</span><span class="o">=</span>&lt;hostname&gt;
</span></span><span class="line"><span class="cl">ceph osd crush move osd.X <span class="nv">rack</span><span class="o">=</span>&lt;rackname&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="82-crush-è§„åˆ™ç®¡ç†">8.2 CRUSH è§„åˆ™ç®¡ç†</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ CRUSH è§„åˆ™</span>
</span></span><span class="line"><span class="cl">ceph osd crush rule ls
</span></span><span class="line"><span class="cl">ceph osd crush rule dump
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»º CRUSH è§„åˆ™</span>
</span></span><span class="line"><span class="cl">ceph osd crush rule create-simple &lt;rule-name&gt; &lt;root&gt; &lt;type&gt;
</span></span><span class="line"><span class="cl">ceph osd crush rule create-replicated &lt;rule-name&gt; &lt;root&gt; &lt;failure-domain&gt; &lt;device-class&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ é™¤ CRUSH è§„åˆ™</span>
</span></span><span class="line"><span class="cl">ceph osd crush rule rm &lt;rule-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æµ‹è¯• CRUSH æ˜ å°„</span>
</span></span><span class="line"><span class="cl">crushtool -i crushmap.bin --test --show-mappings --ruleset <span class="m">0</span> --num-rep <span class="m">3</span> --min-x <span class="m">0</span> --max-x <span class="m">100</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-9-rbd-ç®¡ç†">ğŸ¯ 9. RBD ç®¡ç†</h2>
<h3 id="91-rbd-åŸºæœ¬æ“ä½œ">9.1 RBD åŸºæœ¬æ“ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ›å»º RBD é•œåƒ</span>
</span></span><span class="line"><span class="cl">rbd create --size <span class="m">1024</span> &lt;poolname&gt;/&lt;image-name&gt;
</span></span><span class="line"><span class="cl">rbd create --size 10G --image-feature layering,exclusive-lock mypool/myimage
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ RBD é•œåƒ</span>
</span></span><span class="line"><span class="cl">rbd ls &lt;poolname&gt;
</span></span><span class="line"><span class="cl">rbd info &lt;poolname&gt;/&lt;image-name&gt;
</span></span><span class="line"><span class="cl">rbd du &lt;poolname&gt;/&lt;image-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ é™¤ RBD é•œåƒ</span>
</span></span><span class="line"><span class="cl">rbd rm &lt;poolname&gt;/&lt;image-name&gt;
</span></span><span class="line"><span class="cl">rbd trash mv &lt;poolname&gt;/&lt;image-name&gt;    <span class="c1"># ç§»åŠ¨åˆ°å›æ”¶ç«™</span>
</span></span><span class="line"><span class="cl">rbd trash restore &lt;poolname&gt;/&lt;image-id&gt;  <span class="c1"># ä»å›æ”¶ç«™æ¢å¤</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è°ƒæ•´é•œåƒå¤§å°</span>
</span></span><span class="line"><span class="cl">rbd resize --size <span class="m">2048</span> &lt;poolname&gt;/&lt;image-name&gt;
</span></span><span class="line"><span class="cl">rbd resize --size 2G &lt;poolname&gt;/&lt;image-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºå¿«ç…§</span>
</span></span><span class="line"><span class="cl">rbd snap create &lt;poolname&gt;/&lt;image-name&gt;@&lt;snap-name&gt;
</span></span><span class="line"><span class="cl">rbd snap ls &lt;poolname&gt;/&lt;image-name&gt;
</span></span><span class="line"><span class="cl">rbd snap rm &lt;poolname&gt;/&lt;image-name&gt;@&lt;snap-name&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="92-rbd-é«˜çº§æ“ä½œ">9.2 RBD é«˜çº§æ“ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å…‹éš†é•œåƒ</span>
</span></span><span class="line"><span class="cl">rbd snap protect &lt;poolname&gt;/&lt;parent-image&gt;@&lt;snap-name&gt;
</span></span><span class="line"><span class="cl">rbd clone &lt;poolname&gt;/&lt;parent-image&gt;@&lt;snap-name&gt; &lt;poolname&gt;/&lt;child-image&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å±•å¹³å…‹éš†é•œåƒ</span>
</span></span><span class="line"><span class="cl">rbd flatten &lt;poolname&gt;/&lt;image-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯¼å‡º/å¯¼å…¥é•œåƒ</span>
</span></span><span class="line"><span class="cl">rbd <span class="nb">export</span> &lt;poolname&gt;/&lt;image-name&gt; image.raw
</span></span><span class="line"><span class="cl">rbd <span class="nb">export</span> --export-format <span class="m">2</span> &lt;poolname&gt;/&lt;image-name&gt; image.raw
</span></span><span class="line"><span class="cl">rbd import image.raw &lt;poolname&gt;/&lt;image-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é•œåƒæ˜ å°„</span>
</span></span><span class="line"><span class="cl">rbd map &lt;poolname&gt;/&lt;image-name&gt;
</span></span><span class="line"><span class="cl">rbd unmap /dev/rbdX
</span></span><span class="line"><span class="cl">rbd showmapped
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é•œåƒç‰¹æ€§ç®¡ç†</span>
</span></span><span class="line"><span class="cl">rbd feature <span class="nb">enable</span> &lt;poolname&gt;/&lt;image-name&gt; exclusive-lock
</span></span><span class="line"><span class="cl">rbd feature disable &lt;poolname&gt;/&lt;image-name&gt; deep-flatten
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-10-cephfs-ç®¡ç†">ğŸŒ 10. CephFS ç®¡ç†</h2>
<h3 id="101-cephfs-åŸºæœ¬æ“ä½œ">10.1 CephFS åŸºæœ¬æ“ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ</span>
</span></span><span class="line"><span class="cl">ceph fs new &lt;fs-name&gt; &lt;metadata-pool&gt; &lt;data-pool&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿ</span>
</span></span><span class="line"><span class="cl">ceph fs ls
</span></span><span class="line"><span class="cl">ceph fs status &lt;fs-name&gt;
</span></span><span class="line"><span class="cl">ceph fs get &lt;fs-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ é™¤æ–‡ä»¶ç³»ç»Ÿ</span>
</span></span><span class="line"><span class="cl">ceph fs fail &lt;fs-name&gt;
</span></span><span class="line"><span class="cl">ceph fs rm &lt;fs-name&gt; --yes-i-really-mean-it
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># MDS ç®¡ç†</span>
</span></span><span class="line"><span class="cl">ceph mds stat
</span></span><span class="line"><span class="cl">ceph mds dump
</span></span><span class="line"><span class="cl">ceph mds fail &lt;mds-id&gt;
</span></span><span class="line"><span class="cl">ceph mds repaired &lt;mds-id&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="102-cephfs-å®¢æˆ·ç«¯">10.2 CephFS å®¢æˆ·ç«¯</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŒ‚è½½ CephFS</span>
</span></span><span class="line"><span class="cl">mount -t ceph &lt;mon-addr&gt;:/ /mnt/cephfs -o <span class="nv">name</span><span class="o">=</span>admin,secret<span class="o">=</span>&lt;key&gt;
</span></span><span class="line"><span class="cl">mount -t ceph &lt;mon-addr&gt;:/ /mnt/cephfs -o <span class="nv">name</span><span class="o">=</span>admin,secretfile<span class="o">=</span>/etc/ceph/admin.secret
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨ ceph-fuse</span>
</span></span><span class="line"><span class="cl">ceph-fuse /mnt/cephfs
</span></span><span class="line"><span class="cl">ceph-fuse /mnt/cephfs -o allow_other
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å®¢æˆ·ç«¯è¿æ¥</span>
</span></span><span class="line"><span class="cl">ceph daemon mds.&lt;id&gt; client ls
</span></span><span class="line"><span class="cl">ceph daemon mds.&lt;id&gt; session ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¸¢é™¤å®¢æˆ·ç«¯</span>
</span></span><span class="line"><span class="cl">ceph daemon mds.&lt;id&gt; client evict <span class="nv">id</span><span class="o">=</span>&lt;client-id&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="103-cephfs-é«˜çº§ç®¡ç†">10.3 CephFS é«˜çº§ç®¡ç†</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å­ç›®å½•æŒ‚è½½</span>
</span></span><span class="line"><span class="cl">mount -t ceph &lt;mon-addr&gt;:/subdir /mnt/subdir -o <span class="nv">name</span><span class="o">=</span>admin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é…ç½®å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿ</span>
</span></span><span class="line"><span class="cl">ceph fs flag <span class="nb">set</span> enable_multiple <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç›®å½•é…é¢</span>
</span></span><span class="line"><span class="cl">setfattr -n ceph.quota.max_files -v <span class="m">10000</span> /mnt/cephfs/dir
</span></span><span class="line"><span class="cl">setfattr -n ceph.quota.max_bytes -v <span class="m">1000000000</span> /mnt/cephfs/dir
</span></span><span class="line"><span class="cl">getfattr -n ceph.quota.max_files /mnt/cephfs/dir
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-11-rgw-ç®¡ç†">â˜ï¸ 11. RGW ç®¡ç†</h2>
<h3 id="111-rgw-åŸºæœ¬æ“ä½œ">11.1 RGW åŸºæœ¬æ“ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºç”¨æˆ·</span>
</span></span><span class="line"><span class="cl">radosgw-admin user create --uid<span class="o">=</span>&lt;user-id&gt; --display-name<span class="o">=</span><span class="s2">&#34;&lt;display-name&gt;&#34;</span>
</span></span><span class="line"><span class="cl">radosgw-admin user create --uid<span class="o">=</span>testuser --display-name<span class="o">=</span><span class="s2">&#34;Test User&#34;</span> --email<span class="o">=</span>test@example.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ç”¨æˆ·</span>
</span></span><span class="line"><span class="cl">radosgw-admin user list
</span></span><span class="line"><span class="cl">radosgw-admin user info --uid<span class="o">=</span>&lt;user-id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ é™¤ç”¨æˆ·</span>
</span></span><span class="line"><span class="cl">radosgw-admin user rm --uid<span class="o">=</span>&lt;user-id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä¿®æ”¹ç”¨æˆ·</span>
</span></span><span class="line"><span class="cl">radosgw-admin user modify --uid<span class="o">=</span>&lt;user-id&gt; --display-name<span class="o">=</span><span class="s2">&#34;New Name&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºå­ç”¨æˆ·</span>
</span></span><span class="line"><span class="cl">radosgw-admin subuser create --uid<span class="o">=</span>&lt;user-id&gt; --subuser<span class="o">=</span>&lt;subuser-id&gt; --access<span class="o">=</span>full
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="112-rgw-å¯†é’¥ç®¡ç†">11.2 RGW å¯†é’¥ç®¡ç†</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºè®¿é—®å¯†é’¥</span>
</span></span><span class="line"><span class="cl">radosgw-admin key create --uid<span class="o">=</span>&lt;user-id&gt; --key-type<span class="o">=</span>s3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ é™¤è®¿é—®å¯†é’¥</span>
</span></span><span class="line"><span class="cl">radosgw-admin key rm --uid<span class="o">=</span>&lt;user-id&gt; --key-type<span class="o">=</span>s3 --access-key<span class="o">=</span>&lt;access-key&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”ŸæˆSwiftå¯†é’¥</span>
</span></span><span class="line"><span class="cl">radosgw-admin key create --uid<span class="o">=</span>&lt;user-id&gt; --key-type<span class="o">=</span>swift --gen-secret
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="113-rgw-ç»´æŠ¤">11.3 RGW ç»´æŠ¤</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ£€æŸ¥ bucket ç´¢å¼•</span>
</span></span><span class="line"><span class="cl">radosgw-admin bucket check --bucket<span class="o">=</span>&lt;bucket-name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é‡å»º bucket ç´¢å¼•</span>
</span></span><span class="line"><span class="cl">radosgw-admin bucket reshard --bucket<span class="o">=</span>&lt;bucket-name&gt; --num-shards<span class="o">=</span>&lt;num&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åƒåœ¾å›æ”¶</span>
</span></span><span class="line"><span class="cl">radosgw-admin gc list
</span></span><span class="line"><span class="cl">radosgw-admin gc process
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ä½¿ç”¨ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">radosgw-admin usage show --uid<span class="o">=</span>&lt;user-id&gt;
</span></span><span class="line"><span class="cl">radosgw-admin usage show --show-log-entries<span class="o">=</span><span class="nb">false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Bucket ç®¡ç†</span>
</span></span><span class="line"><span class="cl">radosgw-admin bucket list
</span></span><span class="line"><span class="cl">radosgw-admin bucket stats --bucket<span class="o">=</span>&lt;bucket-name&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-12-é…ç½®ç®¡ç†">ğŸ”§ 12. é…ç½®ç®¡ç†</h2>
<h3 id="121-è¿è¡Œæ—¶é…ç½®">12.1 è¿è¡Œæ—¶é…ç½®</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹é…ç½®</span>
</span></span><span class="line"><span class="cl">ceph config dump
</span></span><span class="line"><span class="cl">ceph config get &lt;daemon-type&gt;.&lt;daemon-id&gt; &lt;option&gt;
</span></span><span class="line"><span class="cl">ceph config show &lt;daemon-type&gt;.&lt;daemon-id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾ç½®é…ç½®</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> &lt;daemon-type&gt; &lt;option&gt; &lt;value&gt;
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> global osd_pool_default_size <span class="m">3</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> osd osd_max_backfills <span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é‡ç½®é…ç½®</span>
</span></span><span class="line"><span class="cl">ceph config rm &lt;daemon-type&gt; &lt;option&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹é…ç½®å†å²</span>
</span></span><span class="line"><span class="cl">ceph config log
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="122-ä¸´æ—¶é…ç½®è°ƒæ•´">12.2 ä¸´æ—¶é…ç½®è°ƒæ•´</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä¸´æ—¶è®¾ç½®é…ç½®ï¼ˆé‡å¯åå¤±æ•ˆï¼‰</span>
</span></span><span class="line"><span class="cl">ceph tell &lt;daemon-type&gt;.&lt;id&gt; config <span class="nb">set</span> &lt;option&gt; &lt;value&gt;
</span></span><span class="line"><span class="cl">ceph tell osd.* config <span class="nb">set</span> debug_osd <span class="m">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹é…ç½®</span>
</span></span><span class="line"><span class="cl">ceph tell &lt;daemon-type&gt;.&lt;id&gt; config show
</span></span><span class="line"><span class="cl">ceph tell &lt;daemon-type&gt;.&lt;id&gt; config get &lt;option&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰¹é‡é…ç½®</span>
</span></span><span class="line"><span class="cl">ceph tell osd.* config <span class="nb">set</span> osd_max_backfills <span class="m">1</span>
</span></span><span class="line"><span class="cl">ceph tell mon.* config <span class="nb">set</span> debug_mon <span class="m">5</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-13-æ€§èƒ½åˆ†æä¸“é¡¹">ğŸ“ˆ 13. æ€§èƒ½åˆ†æä¸“é¡¹</h2>
<h3 id="131-rbd-æ€§èƒ½åˆ†æ">13.1 RBD æ€§èƒ½åˆ†æ</h3>
<h4 id="rbd-æ€§èƒ½æµ‹è¯•å·¥å…·">RBD æ€§èƒ½æµ‹è¯•å·¥å…·</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨ rbd bench è¿›è¡Œæ€§èƒ½æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">rbd bench --io-type write --io-size 4K --io-threads <span class="m">16</span> --io-total 1G &lt;pool&gt;/&lt;image&gt;
</span></span><span class="line"><span class="cl">rbd bench --io-type <span class="nb">read</span> --io-size 4K --io-threads <span class="m">16</span> --io-total 1G &lt;pool&gt;/&lt;image&gt;
</span></span><span class="line"><span class="cl">rbd bench --io-type readwrite --io-size 4K --io-threads <span class="m">16</span> --io-total 1G &lt;pool&gt;/&lt;image&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨ fio è¿›è¡Œè¯¦ç»†æ€§èƒ½æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">fio --name<span class="o">=</span>rbd-test --ioengine<span class="o">=</span>rbd --pool<span class="o">=</span>&lt;pool&gt; --rbdname<span class="o">=</span>&lt;image&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --rw<span class="o">=</span>randwrite --bs<span class="o">=</span>4k --iodepth<span class="o">=</span><span class="m">32</span> --numjobs<span class="o">=</span><span class="m">4</span> --runtime<span class="o">=</span><span class="m">60</span> --group_reporting
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æµ‹è¯•ä¸åŒå—å¤§å°çš„æ€§èƒ½</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> bs in 4k 8k 16k 32k 64k 128k<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Testing block size: </span><span class="nv">$bs</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    rbd bench --io-type write --io-size <span class="nv">$bs</span> --io-threads <span class="m">16</span> --io-total 512M &lt;pool&gt;/&lt;image&gt;
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é¡ºåºè¯»å†™æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">fio --name<span class="o">=</span>seq-write --ioengine<span class="o">=</span>rbd --pool<span class="o">=</span><span class="nb">test</span> --rbdname<span class="o">=</span>testimg <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --rw<span class="o">=</span>write --bs<span class="o">=</span>1M --iodepth<span class="o">=</span><span class="m">1</span> --numjobs<span class="o">=</span><span class="m">1</span> --runtime<span class="o">=</span><span class="m">60</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="rbd-æ€§èƒ½ç›‘æ§">RBD æ€§èƒ½ç›‘æ§</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å®æ—¶ç›‘æ§ RBD I/O</span>
</span></span><span class="line"><span class="cl">rbd perf image iostat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ RBD é•œåƒç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">rbd du &lt;pool&gt;/&lt;image&gt;
</span></span><span class="line"><span class="cl">rbd info &lt;pool&gt;/&lt;image&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç›‘æ§å®¢æˆ·ç«¯ I/O æ¨¡å¼</span>
</span></span><span class="line"><span class="cl">ceph daemon client.&lt;id&gt; perf dump
</span></span><span class="line"><span class="cl">ceph daemon client.&lt;id&gt; perf histogram dump
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ RBD ç¼“å­˜ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">ceph daemon client.&lt;id&gt; config show <span class="p">|</span> grep rbd_cache
</span></span><span class="line"><span class="cl">ceph daemon client.&lt;id&gt; perf dump <span class="p">|</span> grep rbd_cache
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="rbd-æ€§èƒ½è°ƒä¼˜å‚æ•°">RBD æ€§èƒ½è°ƒä¼˜å‚æ•°</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å®¢æˆ·ç«¯ç¼“å­˜ä¼˜åŒ–</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> client rbd_cache <span class="nb">true</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> client rbd_cache_size <span class="m">134217728</span>           <span class="c1"># 128MB</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> client rbd_cache_max_dirty <span class="m">100663296</span>      <span class="c1"># 96MB</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> client rbd_cache_target_dirty <span class="m">67108864</span>    <span class="c1"># 64MB</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> client rbd_cache_max_dirty_age 10.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é¢„è¯»ä¼˜åŒ–</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> client rbd_readahead_trigger_requests <span class="m">10</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> client rbd_readahead_max_bytes <span class="m">524288</span>     <span class="c1"># 512KB</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> client rbd_readahead_disable_after_bytes <span class="m">52428800</span>  <span class="c1"># 50MB</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¹¶å‘ä¼˜åŒ–</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> client rbd_concurrent_management_ops <span class="m">20</span>
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> client rbd_op_threads <span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="132-cephfs-æ€§èƒ½åˆ†æ">13.2 CephFS æ€§èƒ½åˆ†æ</h3>
<h4 id="cephfs-æ€§èƒ½æµ‹è¯•">CephFS æ€§èƒ½æµ‹è¯•</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨ dd è¿›è¡ŒåŸºæœ¬æ€§èƒ½æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>/mnt/cephfs/testfile <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">count</span><span class="o">=</span><span class="m">1000</span> <span class="nv">oflag</span><span class="o">=</span>direct
</span></span><span class="line"><span class="cl">dd <span class="k">if</span><span class="o">=</span>/mnt/cephfs/testfile <span class="nv">of</span><span class="o">=</span>/dev/null <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">iflag</span><span class="o">=</span>direct
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨ iozone è¿›è¡Œå…¨é¢æ€§èƒ½æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">iozone -a -s 1G -r 4k -r 64k -r 1M -i <span class="m">0</span> -i <span class="m">1</span> -i <span class="m">2</span> -f /mnt/cephfs/testfile
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å°æ–‡ä»¶æ€§èƒ½æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">mkdir /mnt/cephfs/small_files_test
</span></span><span class="line"><span class="cl"><span class="nb">time</span> <span class="k">for</span> i in <span class="o">{</span>1..10000<span class="o">}</span><span class="p">;</span> <span class="k">do</span> touch /mnt/cephfs/small_files_test/file_<span class="nv">$i</span><span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å…ƒæ•°æ®æ€§èƒ½æµ‹è¯•</span>
</span></span><span class="line"><span class="cl"><span class="nb">time</span> find /mnt/cephfs -name <span class="s2">&#34;*.txt&#34;</span> <span class="p">|</span> wc -l
</span></span><span class="line"><span class="cl"><span class="nb">time</span> ls -la /mnt/cephfs/large_directory/ <span class="p">|</span> wc -l
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¹¶å‘æ–‡ä»¶æ“ä½œæµ‹è¯•</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> i in <span class="o">{</span>1..10<span class="o">}</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="o">(</span><span class="k">for</span> j in <span class="o">{</span>1..1000<span class="o">}</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">        touch /mnt/cephfs/test_<span class="si">${</span><span class="nv">i</span><span class="si">}</span>_<span class="si">${</span><span class="nv">j</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">done</span><span class="o">)</span> <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="nb">wait</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="cephfs-æ€§èƒ½ç›‘æ§">CephFS æ€§èƒ½ç›‘æ§</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># MDS æ€§èƒ½ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">ceph daemon mds.&lt;id&gt; perf dump
</span></span><span class="line"><span class="cl">ceph daemon mds.&lt;id&gt; session ls
</span></span><span class="line"><span class="cl">ceph daemon mds.&lt;id&gt; status
</span></span><span class="line"><span class="cl">ceph daemon mds.&lt;id&gt; ops
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®¢æˆ·ç«¯æ€§èƒ½ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">ceph daemon client.&lt;id&gt; perf dump
</span></span><span class="line"><span class="cl">ceph daemon client.&lt;id&gt; client_metadata
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ MDS è´Ÿè½½</span>
</span></span><span class="line"><span class="cl">ceph fs status &lt;fsname&gt;
</span></span><span class="line"><span class="cl">ceph mds metadata &lt;mds-id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç›‘æ§ç›®å½•ç¢ç‰‡åŒ–</span>
</span></span><span class="line"><span class="cl">ceph daemon mds.&lt;id&gt; dirfrag ls &lt;path&gt;
</span></span><span class="line"><span class="cl">ceph daemon mds.&lt;id&gt; dirfrag split_info &lt;path&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="133-osd-æ€§èƒ½åˆ†æ">13.3 OSD æ€§èƒ½åˆ†æ</h3>
<h4 id="osd-æ€§èƒ½åŸºå‡†æµ‹è¯•">OSD æ€§èƒ½åŸºå‡†æµ‹è¯•</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># OSD åŸºå‡†æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">ceph tell osd.&lt;id&gt; bench <span class="m">1073741824</span> <span class="m">4194304</span>              <span class="c1"># 1GBæµ‹è¯•ï¼Œ4MBå—å¤§å°</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨ ceph-osd ç›´æ¥æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">ceph-osd -i &lt;id&gt; --test-objectstore --test-objectstore-workload uniform_random
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç£ç›˜æ€§èƒ½æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>/var/lib/ceph/osd/ceph-&lt;id&gt;/test <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">count</span><span class="o">=</span><span class="m">1000</span> <span class="nv">oflag</span><span class="o">=</span>direct
</span></span><span class="line"><span class="cl">dd <span class="k">if</span><span class="o">=</span>/var/lib/ceph/osd/ceph-&lt;id&gt;/test <span class="nv">of</span><span class="o">=</span>/dev/null <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">iflag</span><span class="o">=</span>direct
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç½‘ç»œæ€§èƒ½æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">iperf3 -s    <span class="c1"># åœ¨ç›®æ ‡OSDèŠ‚ç‚¹è¿è¡Œ</span>
</span></span><span class="line"><span class="cl">iperf3 -c &lt;target-osd-ip&gt; -t <span class="m">30</span> -P <span class="m">4</span>    <span class="c1"># åœ¨æºèŠ‚ç‚¹è¿è¡Œ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨ rados bench æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">rados bench -p &lt;pool&gt; <span class="m">60</span> write --no-cleanup
</span></span><span class="line"><span class="cl">rados bench -p &lt;pool&gt; <span class="m">60</span> seq
</span></span><span class="line"><span class="cl">rados bench -p &lt;pool&gt; <span class="m">60</span> rand
</span></span><span class="line"><span class="cl">rados -p &lt;pool&gt; cleanup
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="osd-è¯¦ç»†æ€§èƒ½ç›‘æ§">OSD è¯¦ç»†æ€§èƒ½ç›‘æ§</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># OSD æ€§èƒ½è®¡æ•°å™¨</span>
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; perf dump
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; perf histogram dump
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># OSD æ“ä½œç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; dump_ops_in_flight
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; dump_blocked_ops
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; dump_op_pq_state
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># OSD å­˜å‚¨ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; status
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; df
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ…¢æ“ä½œåˆ†æ</span>
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; dump_slow_requests
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; dump_historic_slow_ops
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># OSD æ¢å¤ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; dump_recovery_reservations
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; dump_backfill_reservations
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="134-æ•´ä½“é›†ç¾¤æ€§èƒ½åˆ†æ">13.4 æ•´ä½“é›†ç¾¤æ€§èƒ½åˆ†æ</h3>
<h4 id="é›†ç¾¤çº§æ€§èƒ½ç›‘æ§">é›†ç¾¤çº§æ€§èƒ½ç›‘æ§</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># é›†ç¾¤ I/O ç»Ÿè®¡</span>
</span></span><span class="line"><span class="cl">ceph iostat
</span></span><span class="line"><span class="cl">watch <span class="s2">&#34;ceph iostat&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># PG åˆ†å¸ƒåˆ†æ</span>
</span></span><span class="line"><span class="cl">ceph pg dump <span class="p">|</span> grep ^pg <span class="p">|</span> awk <span class="s1">&#39;{print $1,$15}&#39;</span> <span class="p">|</span> sort
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®æ—¶æ€§èƒ½ç›‘æ§è„šæœ¬</span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> true<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;</span><span class="k">$(</span>date<span class="k">)</span><span class="s2"> - IOPS: </span><span class="k">$(</span>ceph iostat <span class="p">|</span> grep -E <span class="s1">&#39;read|write&#39;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;</span><span class="k">$(</span>date<span class="k">)</span><span class="s2"> - Health: </span><span class="k">$(</span>ceph health<span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    sleep <span class="m">5</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é›†ç¾¤å»¶è¿Ÿåˆ†æ</span>
</span></span><span class="line"><span class="cl">ceph osd perf <span class="p">|</span> grep -E <span class="s2">&#34;apply_latency|commit_latency&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-14-ceph-ä¸“ç”¨å·¥å…·é›†">ğŸ› ï¸ 14. Ceph ä¸“ç”¨å·¥å…·é›†</h2>
<h3 id="141-æ•°æ®æ¢å¤å’Œè¯Šæ–­å·¥å…·">14.1 æ•°æ®æ¢å¤å’Œè¯Šæ–­å·¥å…·</h3>
<h4 id="ceph-objectstore-tool-å¯¹è±¡å­˜å‚¨å·¥å…·">ceph-objectstore-tool (å¯¹è±¡å­˜å‚¨å·¥å…·)</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ—å‡ºå¯¹è±¡å­˜å‚¨å†…å®¹</span>
</span></span><span class="line"><span class="cl">ceph-objectstore-tool --data-path /var/lib/ceph/osd/ceph-&lt;id&gt; --op list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯¼å‡º PG æ•°æ®</span>
</span></span><span class="line"><span class="cl">ceph-objectstore-tool --data-path /var/lib/ceph/osd/ceph-&lt;id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --op <span class="nb">export</span> --pgid &lt;pg-id&gt; --file /tmp/pg_export.dat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯¼å…¥ PG æ•°æ®</span>
</span></span><span class="line"><span class="cl">ceph-objectstore-tool --data-path /var/lib/ceph/osd/ceph-&lt;id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --op import --file /tmp/pg_export.dat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ é™¤æŸåçš„å¯¹è±¡</span>
</span></span><span class="line"><span class="cl">ceph-objectstore-tool --data-path /var/lib/ceph/osd/ceph-&lt;id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --op remove --pgid &lt;pg-id&gt; --oid &lt;object-id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä¿®å¤å¯¹è±¡å­˜å‚¨</span>
</span></span><span class="line"><span class="cl">ceph-objectstore-tool --data-path /var/lib/ceph/osd/ceph-&lt;id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --op fsck --debug
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å¯¹è±¡ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph-objectstore-tool --data-path /var/lib/ceph/osd/ceph-&lt;id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --op info --pgid &lt;pg-id&gt; --oid &lt;object-id&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ceph-kvstore-tool-é”®å€¼å­˜å‚¨å·¥å…·">ceph-kvstore-tool (é”®å€¼å­˜å‚¨å·¥å…·)</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ—å‡ºé”®å€¼å¯¹</span>
</span></span><span class="line"><span class="cl">ceph-kvstore-tool bluestore-kv /var/lib/ceph/osd/ceph-&lt;id&gt; list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è·å–ç‰¹å®šé”®å€¼</span>
</span></span><span class="line"><span class="cl">ceph-kvstore-tool bluestore-kv /var/lib/ceph/osd/ceph-&lt;id&gt; get &lt;prefix&gt; &lt;key&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ é™¤é”®å€¼å¯¹</span>
</span></span><span class="line"><span class="cl">ceph-kvstore-tool bluestore-kv /var/lib/ceph/osd/ceph-&lt;id&gt; rm &lt;prefix&gt; &lt;key&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‹ç¼©æ•°æ®åº“</span>
</span></span><span class="line"><span class="cl">ceph-kvstore-tool bluestore-kv /var/lib/ceph/osd/ceph-&lt;id&gt; compact
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¤‡ä»½/æ¢å¤é”®å€¼å­˜å‚¨</span>
</span></span><span class="line"><span class="cl">ceph-kvstore-tool bluestore-kv /var/lib/ceph/osd/ceph-&lt;id&gt; backup /tmp/kv_backup
</span></span><span class="line"><span class="cl">ceph-kvstore-tool bluestore-kv /var/lib/ceph/osd/ceph-&lt;id&gt; restore /tmp/kv_backup
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»Ÿè®¡ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph-kvstore-tool bluestore-kv /var/lib/ceph/osd/ceph-&lt;id&gt; stats
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ceph-bluestore-tool-bluestore-ä¸“ç”¨å·¥å…·">ceph-bluestore-tool (BlueStore ä¸“ç”¨å·¥å…·)</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ BlueStore ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph-bluestore-tool show-label --dev /dev/sdX
</span></span><span class="line"><span class="cl">ceph-bluestore-tool prime-osd-dir --dev /dev/sdX --path /var/lib/ceph/osd/ceph-X
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä¿®å¤ BlueStore</span>
</span></span><span class="line"><span class="cl">ceph-bluestore-tool fsck --path /var/lib/ceph/osd/ceph-&lt;id&gt;
</span></span><span class="line"><span class="cl">ceph-bluestore-tool repair --path /var/lib/ceph/osd/ceph-&lt;id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å±•ç¤º BlueStore å…ƒæ•°æ®</span>
</span></span><span class="line"><span class="cl">ceph-bluestore-tool show-label --dev /dev/sdX
</span></span><span class="line"><span class="cl">ceph-bluestore-tool show-label --path /var/lib/ceph/osd/ceph-&lt;id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è“å­˜å‚¨ç©ºé—´åˆ†æ</span>
</span></span><span class="line"><span class="cl">ceph-bluestore-tool bluefs-stats --path /var/lib/ceph/osd/ceph-&lt;id&gt;
</span></span><span class="line"><span class="cl">ceph-bluestore-tool bluefs-bdev-sizes --path /var/lib/ceph/osd/ceph-&lt;id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ†é…å™¨å·¥å…·</span>
</span></span><span class="line"><span class="cl">ceph-bluestore-tool free-dump --path /var/lib/ceph/osd/ceph-&lt;id&gt;
</span></span><span class="line"><span class="cl">ceph-bluestore-tool free-score --path /var/lib/ceph/osd/ceph-&lt;id&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="142-ç›‘æ§å’Œç®¡ç†å·¥å…·">14.2 ç›‘æ§å’Œç®¡ç†å·¥å…·</h3>
<h4 id="crushtool-crush-æ˜ å°„å·¥å…·">crushtool (CRUSH æ˜ å°„å·¥å…·)</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ç¼–è¯‘/åç¼–è¯‘ CRUSH map</span>
</span></span><span class="line"><span class="cl">ceph osd getcrushmap -o crushmap.bin
</span></span><span class="line"><span class="cl">crushtool -d crushmap.bin -o crushmap.txt
</span></span><span class="line"><span class="cl">crushtool -c crushmap.txt -o crushmap_new.bin
</span></span><span class="line"><span class="cl">ceph osd setcrushmap -i crushmap_new.bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æµ‹è¯• CRUSH è§„åˆ™</span>
</span></span><span class="line"><span class="cl">crushtool -i crushmap.bin --test --show-mappings --ruleset <span class="m">0</span> --num-rep <span class="m">3</span> --min-x <span class="m">0</span> --max-x <span class="m">100</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ†æ CRUSH æƒé‡</span>
</span></span><span class="line"><span class="cl">crushtool -i crushmap.bin --show-choose-tries
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># éªŒè¯ CRUSH map</span>
</span></span><span class="line"><span class="cl">crushtool -i crushmap.bin --check
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ˜¾ç¤º CRUSH æ ‘ç»“æ„</span>
</span></span><span class="line"><span class="cl">crushtool -i crushmap.bin --tree
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="monmaptool-monitor-æ˜ å°„å·¥å…·">monmaptool (Monitor æ˜ å°„å·¥å…·)</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ›å»º Monitor map</span>
</span></span><span class="line"><span class="cl">monmaptool --create --add &lt;mon-id&gt; &lt;mon-addr&gt; --fsid &lt;uuid&gt; monmap.bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ Monitor map</span>
</span></span><span class="line"><span class="cl">monmaptool --print monmap.bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ·»åŠ /åˆ é™¤ Monitor</span>
</span></span><span class="line"><span class="cl">monmaptool --add &lt;mon-id&gt; &lt;mon-addr&gt; monmap.bin
</span></span><span class="line"><span class="cl">monmaptool --rm &lt;mon-id&gt; monmap.bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆæ–°çš„ fsid</span>
</span></span><span class="line"><span class="cl">uuidgen
</span></span><span class="line"><span class="cl">monmaptool --create --fsid <span class="k">$(</span>uuidgen<span class="k">)</span> monmap.bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä»ç°æœ‰é›†ç¾¤æå–</span>
</span></span><span class="line"><span class="cl">ceph mon getmap -o monmap.bin
</span></span><span class="line"><span class="cl">monmaptool --print monmap.bin
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="osdmaptool-osd-æ˜ å°„å·¥å…·">osdmaptool (OSD æ˜ å°„å·¥å…·)</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å¯¼å‡º OSD map</span>
</span></span><span class="line"><span class="cl">ceph osd getmap -o osdmap.bin
</span></span><span class="line"><span class="cl">osdmaptool osdmap.bin --print
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æµ‹è¯• PG æ˜ å°„</span>
</span></span><span class="line"><span class="cl">osdmaptool osdmap.bin --test-map-pgs --pool &lt;pool-id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºå¢é‡ map</span>
</span></span><span class="line"><span class="cl">osdmaptool --createsimple <span class="m">3</span> osdmap.bin --with-default-pool
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯¼å‡ºç‰¹å®š epoch çš„ map</span>
</span></span><span class="line"><span class="cl">ceph osd getmap &lt;epoch&gt; -o osdmap_&lt;epoch&gt;.bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ˜¾ç¤º OSD æ ‘</span>
</span></span><span class="line"><span class="cl">osdmaptool osdmap.bin --tree
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="143-æ•°æ®è¿ç§»å’ŒåŒæ­¥å·¥å…·">14.3 æ•°æ®è¿ç§»å’ŒåŒæ­¥å·¥å…·</h3>
<h4 id="rados-å¯¹è±¡å­˜å‚¨å®¢æˆ·ç«¯">rados (å¯¹è±¡å­˜å‚¨å®¢æˆ·ç«¯)</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åŸºæœ¬å¯¹è±¡æ“ä½œ</span>
</span></span><span class="line"><span class="cl">rados -p &lt;pool&gt; put &lt;object&gt; &lt;file&gt;
</span></span><span class="line"><span class="cl">rados -p &lt;pool&gt; get &lt;object&gt; &lt;file&gt;
</span></span><span class="line"><span class="cl">rados -p &lt;pool&gt; ls
</span></span><span class="line"><span class="cl">rados -p &lt;pool&gt; rm &lt;object&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰¹é‡æ“ä½œ</span>
</span></span><span class="line"><span class="cl">rados -p &lt;pool&gt; ls <span class="p">|</span> xargs -I <span class="o">{}</span> rados -p &lt;pool&gt; rm <span class="o">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åŸºå‡†æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">rados bench -p &lt;pool&gt; <span class="m">60</span> write --no-cleanup
</span></span><span class="line"><span class="cl">rados bench -p &lt;pool&gt; <span class="m">60</span> seq
</span></span><span class="line"><span class="cl">rados bench -p &lt;pool&gt; <span class="m">60</span> rand
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¸…ç†åŸºå‡†æµ‹è¯•æ•°æ®</span>
</span></span><span class="line"><span class="cl">rados -p &lt;pool&gt; cleanup
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯¹è±¡å±æ€§æ“ä½œ</span>
</span></span><span class="line"><span class="cl">rados -p &lt;pool&gt; setxattr &lt;object&gt; &lt;attr&gt; &lt;value&gt;
</span></span><span class="line"><span class="cl">rados -p &lt;pool&gt; getxattr &lt;object&gt; &lt;attr&gt;
</span></span><span class="line"><span class="cl">rados -p &lt;pool&gt; listxattr &lt;object&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç›‘è§†å¯¹è±¡å˜åŒ–</span>
</span></span><span class="line"><span class="cl">rados -p &lt;pool&gt; watch &lt;object&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="rbd-mirror-rbd-é•œåƒå·¥å…·">rbd-mirror (RBD é•œåƒå·¥å…·)</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å¯ç”¨é•œåƒ</span>
</span></span><span class="line"><span class="cl">rbd mirror pool <span class="nb">enable</span> &lt;pool&gt; pool
</span></span><span class="line"><span class="cl">rbd mirror pool <span class="nb">enable</span> &lt;pool&gt; image
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é…ç½®é•œåƒ</span>
</span></span><span class="line"><span class="cl">rbd mirror image <span class="nb">enable</span> &lt;pool&gt;/&lt;image&gt; snapshot
</span></span><span class="line"><span class="cl">rbd mirror image <span class="nb">enable</span> &lt;pool&gt;/&lt;image&gt; journal
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹é•œåƒçŠ¶æ€</span>
</span></span><span class="line"><span class="cl">rbd mirror pool status &lt;pool&gt;
</span></span><span class="line"><span class="cl">rbd mirror image status &lt;pool&gt;/&lt;image&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¼ºåˆ¶é‡æ–°åŒæ­¥</span>
</span></span><span class="line"><span class="cl">rbd mirror image resync &lt;pool&gt;/&lt;image&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ•…éšœè½¬ç§»</span>
</span></span><span class="line"><span class="cl">rbd mirror image promote &lt;pool&gt;/&lt;image&gt;
</span></span><span class="line"><span class="cl">rbd mirror image demote &lt;pool&gt;/&lt;image&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ceph-crash-å´©æºƒæŠ¥å‘Šå·¥å…·">ceph-crash (å´©æºƒæŠ¥å‘Šå·¥å…·)</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å´©æºƒæŠ¥å‘Š</span>
</span></span><span class="line"><span class="cl">ceph crash ls
</span></span><span class="line"><span class="cl">ceph crash info &lt;crash-id&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å½’æ¡£å´©æºƒæŠ¥å‘Š</span>
</span></span><span class="line"><span class="cl">ceph crash archive &lt;crash-id&gt;
</span></span><span class="line"><span class="cl">ceph crash archive-all
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆå´©æºƒæŠ¥å‘Š</span>
</span></span><span class="line"><span class="cl">ceph crash post -i &lt;crash-dump-file&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»Ÿè®¡å´©æºƒæŠ¥å‘Š</span>
</span></span><span class="line"><span class="cl">ceph crash stat
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ceph-volume-å·ç®¡ç†å·¥å…·">ceph-volume (å·ç®¡ç†å·¥å…·)</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># LVM æ–¹å¼åˆ›å»º OSD</span>
</span></span><span class="line"><span class="cl">ceph-volume lvm create --data /dev/sdb
</span></span><span class="line"><span class="cl">ceph-volume lvm create --data /dev/sdb --block.wal /dev/nvme0n1p1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‡†å¤‡å’Œæ¿€æ´»åˆ†ç¦»</span>
</span></span><span class="line"><span class="cl">ceph-volume lvm prepare --data /dev/sdb --osd-id <span class="m">0</span>
</span></span><span class="line"><span class="cl">ceph-volume lvm activate <span class="m">0</span> &lt;osd-uuid&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹ LVM ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph-volume lvm list
</span></span><span class="line"><span class="cl">ceph-volume lvm list /dev/sdb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç®€å•æ–¹å¼åˆ›å»º OSD</span>
</span></span><span class="line"><span class="cl">ceph-volume simple scan /dev/sdb
</span></span><span class="line"><span class="cl">ceph-volume simple activate &lt;osd-id&gt; &lt;osd-uuid&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-15-æ•…éšœæ’æŸ¥">ğŸš¨ 15. æ•…éšœæ’æŸ¥</h2>
<h3 id="151-æ—¥å¿—æŸ¥çœ‹">15.1 æ—¥å¿—æŸ¥çœ‹</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å„æœåŠ¡æ—¥å¿—</span>
</span></span><span class="line"><span class="cl">journalctl -u ceph-mon@&lt;hostname&gt; -f
</span></span><span class="line"><span class="cl">journalctl -u ceph-osd@&lt;id&gt; -f
</span></span><span class="line"><span class="cl">journalctl -u ceph-mds@&lt;hostname&gt; -f
</span></span><span class="line"><span class="cl">journalctl -u ceph-mgr@&lt;hostname&gt; -f
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŒ‰æ—¶é—´èŒƒå›´æŸ¥çœ‹æ—¥å¿—</span>
</span></span><span class="line"><span class="cl">journalctl -u ceph-osd@&lt;id&gt; --since <span class="s2">&#34;2023-01-01 00:00:00&#34;</span> --until <span class="s2">&#34;2023-01-01 23:59:59&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è°ƒæ•´æ—¥å¿—çº§åˆ«</span>
</span></span><span class="line"><span class="cl">ceph tell osd.* config <span class="nb">set</span> debug_osd <span class="m">10</span>
</span></span><span class="line"><span class="cl">ceph tell mon.* config <span class="nb">set</span> debug_mon <span class="m">10</span>
</span></span><span class="line"><span class="cl">ceph tell mds.* config <span class="nb">set</span> debug_mds <span class="m">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹å®æ—¶é”™è¯¯</span>
</span></span><span class="line"><span class="cl">tail -f /var/log/ceph/ceph.log <span class="p">|</span> grep -i error
</span></span><span class="line"><span class="cl">tail -f /var/log/ceph/ceph-osd.*.log <span class="p">|</span> grep -i slow
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="152-å¸¸è§é—®é¢˜æ’æŸ¥">15.2 å¸¸è§é—®é¢˜æ’æŸ¥</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># PG ä¸ä¸€è‡´é—®é¢˜</span>
</span></span><span class="line"><span class="cl">ceph health detail <span class="p">|</span> grep inconsistent
</span></span><span class="line"><span class="cl">ceph pg &lt;pgid&gt; query
</span></span><span class="line"><span class="cl">ceph pg repair &lt;pgid&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># OSD æ»¡è½½é—®é¢˜</span>
</span></span><span class="line"><span class="cl">ceph osd df <span class="p">|</span> grep -E <span class="s2">&#34;(95|96|97|98|99)%&#34;</span>
</span></span><span class="line"><span class="cl">ceph osd reweight-by-utilization
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ…¢è¯·æ±‚é—®é¢˜</span>
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; dump_slow_requests
</span></span><span class="line"><span class="cl">ceph daemon osd.&lt;id&gt; dump_historic_slow_ops
</span></span><span class="line"><span class="cl">ceph config <span class="nb">set</span> osd debug_osd <span class="m">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ—¶é’ŸåŒæ­¥é—®é¢˜</span>
</span></span><span class="line"><span class="cl">ceph time-sync-status
</span></span><span class="line"><span class="cl">ntpq -p
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç£ç›˜ç©ºé—´é—®é¢˜</span>
</span></span><span class="line"><span class="cl">ceph df
</span></span><span class="line"><span class="cl">ceph osd df
</span></span><span class="line"><span class="cl">df -h /var/lib/ceph/osd/
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="-16-å¤‡ä»½æ¢å¤">ğŸ”„ 16. å¤‡ä»½æ¢å¤</h2>
<h3 id="161-æ•°æ®å¤‡ä»½">16.1 æ•°æ®å¤‡ä»½</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å¯¼å‡º Monitor map</span>
</span></span><span class="line"><span class="cl">ceph mon getmap -o monmap.bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯¼å‡º OSD map</span>
</span></span><span class="line"><span class="cl">ceph osd getmap -o osdmap.bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯¼å‡º CRUSH map</span>
</span></span><span class="line"><span class="cl">ceph osd getcrushmap -o crushmap.bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¤‡ä»½ ceph.conf å’Œå¯†é’¥</span>
</span></span><span class="line"><span class="cl">cp /etc/ceph/ceph.conf /backup/
</span></span><span class="line"><span class="cl">cp /etc/ceph/ceph.client.admin.keyring /backup/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¤‡ä»½è®¤è¯ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph auth <span class="nb">export</span> &gt; /backup/ceph_auth.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¤‡ä»½å­˜å‚¨æ± ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph osd pool ls detail &gt; /backup/pools.txt
</span></span><span class="line"><span class="cl">ceph pg dump &gt; /backup/pg_dump.txt
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="162-ç¾éš¾æ¢å¤">16.2 ç¾éš¾æ¢å¤</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä»å•ä¸ª OSD æ¢å¤æ•°æ®</span>
</span></span><span class="line"><span class="cl">ceph-objectstore-tool --data-path /var/lib/ceph/osd/ceph-X <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --export-remove --pgid &lt;pgid&gt; --file /tmp/pg_export
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é‡å»º Monitor</span>
</span></span><span class="line"><span class="cl">ceph-mon --mkfs -i &lt;mon-id&gt; --monmap monmap.bin --keyring mon.keyring
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¢å¤è®¤è¯ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">ceph auth import -i /backup/ceph_auth.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¢å¤ CRUSH map</span>
</span></span><span class="line"><span class="cl">ceph osd setcrushmap -i /backup/crushmap.bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># OSD æ•°æ®æ¢å¤</span>
</span></span><span class="line"><span class="cl">ceph-objectstore-tool --data-path /var/lib/ceph/osd/ceph-X <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --op import --file /tmp/pg_export
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="163-rbd-å¤‡ä»½æ¢å¤">16.3 RBD å¤‡ä»½æ¢å¤</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># RBD å¿«ç…§å¤‡ä»½</span>
</span></span><span class="line"><span class="cl">rbd snap create &lt;pool&gt;/&lt;image&gt;@backup-<span class="k">$(</span>date +%Y%m%d<span class="k">)</span>
</span></span><span class="line"><span class="cl">rbd <span class="nb">export</span> &lt;pool&gt;/&lt;image&gt;@&lt;snapshot&gt; /backup/image_backup.raw
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># RBD å¢é‡å¤‡ä»½</span>
</span></span><span class="line"><span class="cl">rbd export-diff &lt;pool&gt;/&lt;image&gt;@&lt;snap1&gt; &lt;pool&gt;/&lt;image&gt;@&lt;snap2&gt; /backup/diff.raw
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># RBD æ¢å¤</span>
</span></span><span class="line"><span class="cl">rbd import /backup/image_backup.raw &lt;pool&gt;/&lt;new-image&gt;
</span></span><span class="line"><span class="cl">rbd import-diff /backup/diff.raw &lt;pool&gt;/&lt;image&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æœ¬æ–‡æ¡£æŒç»­æ›´æ–°ï¼Œå»ºè®®å®šæœŸæ£€æŸ¥æœ€æ–°ç‰ˆæœ¬ã€‚å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åé¦ˆã€‚</strong></p>
<p><em>æœ€åæ›´æ–°æ—¶é—´ï¼š2025å¹´06æœˆ</em></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">YLShi && WuHongSong</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        0001-01-01
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      
      <nav class="post-nav">
        <a class="prev" href="/post/ceph-content/operation-skills/zh-cn/ceph%E9%9B%86%E7%BE%A4%E5%B7%A1%E6%A3%80%E8%84%9A%E6%9C%AC/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default"></span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="YLShiJustFly/YLShiJustFly.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:youseeicanfly@126.com" class="iconfont icon-email" title="email"></a>
      <a href="https://www.zhihu.com/people/tan-xi-liu-nian" class="iconfont icon-zhihu" title="zhihu"></a>
  <a href="http://YLShiJustFly.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> site pv: <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> site uv: <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2022 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span><span>YLShi && WuHongSong</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.191509a5c8442abdb6eb5020a332fd59bdd83a7e78a2d2241108df9113504292.js"></script>








</body>
</html>
