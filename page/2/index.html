<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Friends&#39; Life and Work Space</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="ceph-deep-dive" /><meta name="description" content="Private Blog of YLShi, HongsongWu" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.100.2 with theme even" />


<link rel="canonical" href="http://YLShiJustFly.github.io/" />
  <link href="http://YLShiJustFly.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Friends&#39; Life and Work Space" />
  <link href="http://YLShiJustFly.github.io/index.xml" rel="feed" type="application/rss+xml" title="Friends&#39; Life and Work Space" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Friends&#39; Life and Work Space" />
<meta property="og:description" content="Private Blog of YLShi, HongsongWu" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://YLShiJustFly.github.io/" />

<meta itemprop="name" content="Friends&#39; Life and Work Space">
<meta itemprop="description" content="Private Blog of YLShi, HongsongWu"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Friends&#39; Life and Work Space"/>
<meta name="twitter:description" content="Private Blog of YLShi, HongsongWu"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Friends&#39; Life and Work Space</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Friends&#39; Life and Work Space</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <section id="posts" class="posts">
    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/ceph-content/operation-skills/zh-cn/ceph%E9%9B%86%E7%BE%A4%E5%B7%A1%E6%A3%80%E8%84%9A%E6%9C%AC/">cephé›†ç¾¤å·¡æ£€è„šæœ¬</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2025-08-24 </span>
      <div class="post-category">
          <a href="/categories/ceph/"> ceph </a>
          </div>
        <span class="more-meta"> 4016 words </span>
        <span class="more-meta"> 9 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      ğŸ› ï¸ è„šæœ¬åŠŸèƒ½ç‰¹ç‚¹ å…¨é¢çš„æ£€æŸ¥é¡¹ç›® âœ… é›†ç¾¤è¿æ¥çŠ¶æ€ - éªŒè¯Cephé›†ç¾¤å¯è¾¾æ€§ âœ… å¥åº·çŠ¶æ€åˆ†æ - HEALTH_OK/WARN/ERRè¯¦ç»†åˆ†æ âœ… Monit
    </div>
    <div class="read-more">
      <a href="/post/ceph-content/operation-skills/zh-cn/ceph%E9%9B%86%E7%BE%A4%E5%B7%A1%E6%A3%80%E8%84%9A%E6%9C%AC/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/ceph-content/distributed-storage/en/daos-file-system-phoenix-rising-after-optanes-end/">DAOS File System: Phoenix Rising After Optane&#39;s End</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2025-08-24 </span>
      <div class="post-category">
          <a href="/categories/ceph/"> ceph </a>
          </div>
        <span class="more-meta"> 762 words </span>
        <span class="more-meta"> 4 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      Preface: Dominating the IO500 Rankings Having seen the DAOS project dominating the IO500 rankings, I&rsquo;ve been keeping an eye on this project (though not diving deep into it). Background In previous articles, I briefly introduced the DAOS distributed storage project. However, with Intel terminating the Optane business in 2022, many people began to wonder: Can DAOS continue after losing its &ldquo;core hardware support&rdquo;? Where is its future?
Short-term Impact, but Not the End The discontinuation of Optane did have a significant impact on DAOS, especially in metadata acceleration and persistence.
    </div>
    <div class="read-more">
      <a href="/post/ceph-content/distributed-storage/en/daos-file-system-phoenix-rising-after-optanes-end/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/ceph-content/distributed-storage/zh-cn/daos%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%90%8Eoptane%E6%97%B6%E4%BB%A3%E7%9A%84%E5%87%A4%E5%87%B0%E6%B6%85%E6%A7%83/">DAOSæ–‡ä»¶ç³»ç»Ÿï¼šåOptaneæ—¶ä»£çš„å‡¤å‡°æ¶…æ§ƒ</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2025-08-24 </span>
      <div class="post-category">
          <a href="/categories/ceph/"> ceph </a>
          </div>
        <span class="more-meta"> 1743 words </span>
        <span class="more-meta"> 4 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      å‰è¨€ï¼šIO500ä¸Šçš„å± æ¦œ å› ä¸ºçœ‹åˆ°DAOSé¡¹ç›®åœ¨IO500ä¸Šçš„å± æ¦œï¼Œæ‰€ä»¥ä¸€ç›´å¯¹è¿™ä¸ªé¡¹ç›®ä¿æŒç€å…³æ³¨(æœªæ·±å…¥)ã€‚ èƒŒæ™¯ åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œç®€è¦ä»‹ç»äº†DA
    </div>
    <div class="read-more">
      <a href="/post/ceph-content/distributed-storage/zh-cn/daos%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%90%8Eoptane%E6%97%B6%E4%BB%A3%E7%9A%84%E5%87%A4%E5%87%B0%E6%B6%85%E6%A7%83/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/ceph-content/code-analysis/en/execution-flow-analysis-of-the-ceph-mgr-balancer-module-/">Execution Flow Analysis of the Ceph mgr-balancer Module </a></h1>
    <div class="post-meta">
      <span class="post-time"> 2025-08-24 </span>
      <div class="post-category">
          <a href="/categories/ceph/"> ceph </a>
          </div>
        <span class="more-meta"> 1182 words </span>
        <span class="more-meta"> 6 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      As OSD are replaced and the cluster scales in and out, the distribution of PGs across OSDs becomes increasingly unbalanced. This leads to discrepancies in actual usage rates of individual OSDs, reducing the overall utilization rate of cluster. The ceph balancer module addresses this by adjusting weights or specifying PG mappings via upmap to redistribute PGs evently.
This article analyzes the execution flow when using balancer upmap mode, based on the ceph Pacific version.
    </div>
    <div class="read-more">
      <a href="/post/ceph-content/code-analysis/en/execution-flow-analysis-of-the-ceph-mgr-balancer-module-/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/ceph-content/architecture-analysis/en/osd/">OSD</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2025-08-24 </span>
      <div class="post-category">
          <a href="/categories/ceph/"> ceph </a>
          </div>
        <span class="more-meta"> 793 words </span>
        <span class="more-meta"> 4 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      Classical OSD Overall Architecture Diagram 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 graph TB subgraph &#34;OSD Process Architecture&#34; OSD[OSD Main Class] OSDService[OSDService&lt;br/&gt;Core Service] ShardedOpWQ[ShardedOpWQ&lt;br/&gt;Sharded Operation Queue] Messenger[Messenger&lt;br/&gt;Message System] end subgraph &#34;PG Management Subsystem&#34; PGMap[pg_map&lt;br/&gt;PG Mapping Table] PG[PG Class&lt;br/&gt;Placement Group] PGBackend[PGBackend&lt;br/&gt;Backend Implementation] ReplicatedBackend[ReplicatedBackend] ECBackend[ECBackend] end subgraph &#34;Object Storage Subsystem&#34; ObjectStore[ObjectStore&lt;br/&gt;Storage Abstraction Layer] FileStore[FileStore&lt;br/&gt;Filesystem Storage] BlueStore[BlueStore&lt;br/&gt;Raw Device Storage] ObjectContext[ObjectContext&lt;br/&gt;Object Context] end subgraph &#34;Recovery Subsystem&#34; RecoveryState[RecoveryState&lt;br/&gt;Recovery State Machine] PeeringState[PeeringState&lt;br/&gt;Peering State] BackfillState[BackfillState&lt;br/&gt;Backfill State] RecoveryWQ[RecoveryWQ&lt;br/&gt;Recovery Work Queue] end subgraph &#34;Monitoring &amp; Statistics&#34; PGStats[PGStats&lt;br/&gt;PG Statistics] OSDStats[OSDStats&lt;br/&gt;OSD Statistics] PerfCounters[PerfCounters&lt;br/&gt;Performance Counters] Logger[Logger&lt;br/&gt;Logging System] end OSD --&gt; OSDService OSD --&gt; ShardedOpWQ OSD --&gt; Messenger OSD --&gt; PGMap PGMap --&gt; PG PG --&gt; PGBackend PGBackend --&gt; ReplicatedBackend PGBackend --&gt; ECBackend PG --&gt; ObjectStore ObjectStore --&gt; FileStore ObjectStore --&gt; BlueStore PG --&gt; ObjectContext PG --&gt; RecoveryState RecoveryState --&gt; PeeringState RecoveryState --&gt; BackfillState OSD --&gt; RecoveryWQ PG --&gt; PGStats OSD --&gt; OSDStats OSD --&gt; PerfCounters OSD --&gt; Logger OSD Core Class Structure Details 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 classDiagram class OSD { -int whoami -Messenger* cluster_messenger -Messenger* client_messenger -MonClient* monc -MgrClient* mgrc -ObjectStore* store -OSDService service -map~spg_t,PG*~ pg_map -RWLock pg_map_lock -OSDMapRef osdmap -epoch_t up_epoch -ThreadPool op_tp -ShardedOpWQ op_sharded_wq -RecoveryWQ recovery_wq -SnapTrimWQ snap_trim_wq -ScrubWQ scrub_wq +handle_osd_op(MOSDOp* op) +handle_replica_op(MOSDSubOp* op) +handle_pg_create(MOSDPGCreate* m) +handle_osd_map(MOSDMap* m) +process_peering_events() +start_boot() +shutdown() } class OSDService { -OSD* osd -CephContext* cct -ObjectStore* store -LogClient* log_client -PGRecoveryStats recovery_stats -Throttle recovery_ops_throttle -Throttle recovery_bytes_throttle -ClassHandler* class_handler -map~hobject_t,ObjectContext*~ object_contexts -LRUExpireMap object_context_lru +get_object_context(hobject_t oid) +release_object_context(ObjectContext* obc) +queue_for_recovery(PG* pg) +queue_for_scrub(PG* pg) } class ShardedOpWQ { -vector~OpWQ*~ shards -atomic~uint32_t~ next_shard +queue(OpRequestRef op) +dequeue(OpWQ* shard) +process_batch() } class OpWQ { -ThreadPool::TPHandle* handle -list~OpRequestRef~ ops -Mutex ops_lock +enqueue_front(OpRequestRef op) +enqueue_back(OpRequestRef op) +dequeue() +process() } OSD --&gt; OSDService OSD --&gt; ShardedOpWQ ShardedOpWQ --&gt; OpWQ PG Class Detailed Structure 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 classDiagram class PG { -spg_t pg_id -OSDService* osd -CephContext* cct -PGBackend* pgbackend -ObjectStore::CollectionHandle ch -RecoveryState recovery_state -PGLog pg_log -IndexedLog projected_log -eversion_t last_update -epoch_t last_epoch_started -set~pg_shard_t~ up -set~pg_shard_t~ acting -map~hobject_t,ObjectContext*~ object_contexts -Mutex pg_lock -Cond pg_cond -list~OpRequestRef~ waiting_for_peered -list~OpRequestRef~ waiting_for_active -map~eversion_t,list~OpRequestRef~~ waiting_for_ondisk +do_request(OpRequestRef op) +do_op(OpRequestRef op) +do_sub_op(OpRequestRef op) +execute_ctx(OpContext* ctx) +issue_repop(RepGather* repop) +eval_repop(RepGather* repop) +start_recovery_ops() +recover_object() +on_change(ObjectStore::Transaction* t) +activate() +clean_up_local() } class RecoveryState { -PG* pg -RecoveryMachine machine -boost::statechart::state_machine base +handle_event(const boost::statechart::event_base&amp; evt) +process_peering_events() +advance_map() +need_up_thru() } class PGLog { -IndexedLog log -eversion_t tail -eversion_t head -list~pg_log_entry_t~ pending_log -set~eversion_t~ pending_dups +add(pg_log_entry_t&amp; entry) +trim(eversion_t trim_to) +merge_log(ObjectStore::Transaction* t) +write_log_and_missing() } class PGBackend { -PG* parent -ObjectStore* store -CephContext* cct +submit_transaction() +objects_list_partial() +objects_list_range() +objects_get_attr() +objects_read_sync() +be_deep_scrub() } PG --&gt; RecoveryState PG --&gt; PGLog PG --&gt; PGBackend Read/Write IO Processing Detailed Flow Write Operation Complete Flow 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 sequenceDiagram participant Client participant OSD participant PG participant OpWQ participant ObjectStore participant Journal participant Replica Client-&gt;&gt;OSD: MOSDOp(write) OSD-&gt;&gt;OSD: handle_osd_op() Note right of OSD: 1.
    </div>
    <div class="read-more">
      <a href="/post/ceph-content/architecture-analysis/en/osd/" class="read-more-link">Read more...</a>
    </div>
  </div>
</article>

    </section>
  
  <nav class="pagination">
    <a class="prev" href="/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text">Prev</span>
      </a>
    <a class="next" href="/page/3/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
  </nav>
        </div>
        

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:youseeicanfly@126.com" class="iconfont icon-email" title="email"></a>
      <a href="https://www.zhihu.com/people/tan-xi-liu-nian" class="iconfont icon-zhihu" title="zhihu"></a>
  <a href="http://YLShiJustFly.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> site pv: <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> site uv: <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2022 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span><span>ceph-deep-dive</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.191509a5c8442abdb6eb5020a332fd59bdd83a7e78a2d2241108df9113504292.js"></script>








</body>
</html>
